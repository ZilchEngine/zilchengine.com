<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Advantages of Archetypes | ZilchEngine </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Advantages of Archetypes | ZilchEngine ">
      
      <link rel="icon" href="../../../../../favicon.ico">
      <link rel="stylesheet" href="../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ZilchEngine/ZilchEngineWebsite/blob/master/docs/zilch_editor_documentation/zilchmanual/architecture/archetypes/archetype_basics.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../../../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../images/ZilchLogo.svg" alt="ZilchEngine">
            ZilchEngine
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">

<p>An Archetype <a href="https://github.com/ZilchEngine/ZilchDocs/blob/master/zilch_editor_documentation/zilchmanual/architecture/resources.md"> Resource </a> is the serialized definition of a Cog (Game Object Composition) which can be used as a template from which to create new cogs from. The core benefit of Archetypes is that any changes made to the Archetype affect each object created from the Archetype. These objects are called <strong>instances</strong> of the Archetype.</p>
<h1 id="advantages-of-archetypes">Advantages of Archetypes</h1>
<p>Often in games we find reasons to have several copies of the same object in the game at once. The game could take place in a forest with thousands of trees and rocks with subtle differences. It could be an arcade shooter with hundreds of identical enemies swarming towards the player. In any case where there is duplicate object creation Archetypes can save us both development time, and performance at runtime.</p>
<p>If a level has hundreds of instances of the same character Archetype, all those characters can be modified at the same time by modifying the Archetype. Where as if each chracter was not Archetyped, they would have to be individually modified which is slow. One could also group select and modify which may not be practical depending on the placement of objects in the level. While making full use of the Archetype system takes forethought, it increases development efficiency over the course of a project.</p>
<p>Take the example of a game with an army of identical characters which are made out of instances of just 1 or 2 Archetypes the engine can load it much faster than if each character was its own unique Cog with no shared Archetype. This is because after the Archetype is loaded by the engine, it can be used by the engine to create/render the instances of it in the army. As opposed to the engine having to load a copy of the object data for each non-Archetyped tree object.</p>
<h1 id="creating-archetypes">Creating Archetypes</h1>
<p>Creating an Archetype is fairly simple.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46803.png" alt="2017_07_07_11_34_28_Zilch_Editor_ArchetypeDocumentation"></p>
<p>Simply provide an name for the new Archetype in the Archetype field and press Enter or the <img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46805.png" alt="image"> button. This will create the new Archetype resource from the selected object causing to to appear under the Archetype tag in the Resource Window.</p>
<h1 id="creating-objects-from-archetypes">Creating Objects from Archetypes</h1>
<p>Creating a new instance of an existing Archetype is simple and can be done through multiple approaches.</p>
<h2 id="instance-from-the-resource-library">Instance from the Resource Library</h2>
<p>By clicking and dragging an Archetype resource from the resource library into the Level Window we can create a new instance of that Archetype.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46827.gif" alt="ArchetypeInstantiationFromLibrary"></p>
<h2 id="copying-an-instance">Copying an Instance</h2>
<p>Objects which are an instance of an Archetype can be duplicated via copy &amp; paste to create a new instance of the same Archetype.</p>
<ul>
<li><code>ctrl + c</code></li>
<li><code>ctrl + v</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46829.gif" alt="ArchetypeCopyPaste"></p>
<p><em>Here <code>ctrl + +c</code> and <code>ctrl + v</code> are used then <code>ctrl + click + drag</code></em></p>
<h2 id="instances-at-runtime">Instances at Runtime</h2>
<p>Archetypes are essential for creating objects at runtime. Here is a short example of how one might create instances of an Archetype at runtime.</p>
<pre><code>class ObjectSpawner : NadaComponent
{
  [Property]
  var ObjectArchetype : Archetype = Archetype.MyArchetype;
  
  [Property]
  var SpawnRate : Real = 1.0;
  
  var Timer : Real = 0.0;
  
  function Initialize(init : CogInitializer)
  {
    Zilch.Connect(this.Space, Events.LogicUpdate, this.OnLogicUpdate);
  }

  function OnLogicUpdate(event : LogicUpdate)
  {
    this.Timer += event.Dt;
    if(this.Timer &gt; this.SpawnRate)
    {
      this.Timer = 0.0;
      this.Space.Create(this.ObjectArchetype);
    }
  }
}
</code></pre>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46831.gif" alt="ArchetypeInstantiationRuntime"></p>
<p><em>Here you can see the above <code>ObjectSpawner</code> script running.</em></p>
<p>As you can see the function <code>Space.Create()</code> is how you instantiate Archetypes at runtime from script. There is also <code>Space.CreateAtPosition()</code> which allows you to specify a position for the object to spawn at as opposed to the Space origin.</p>
<h1 id="basic-archetype-modifications">Basic Archetype Modifications</h1>
<p>When an Archetype instance is modified it turns orange.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46846.png" alt="image"></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46848.png" alt="image"></p>
<p>Below the behaviors various types of modifications are described.</p>
<h2 id="property-modifications">Property Modifications</h2>
<p>When a property field of an  an Archetype instance is edited it is turned orange to mark it as modified. This is a common theme as other items will turn orange when modified.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46838.png" alt="image"> <img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46836.png" alt="image"></p>
<h3 id="local-modification-override">Local Modification Override</h3>
<p>It should be noted that based on the above modifications to <code>Transform</code> the Archetype instance will not be marked as modified.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46844.png" alt="image"></p>
<p>This is because the properties such as <code>Transform.Translation</code>, <code>Transform.Rotation</code>, <code>Transform.Scale</code>, and <code>Area.Size</code> have the <code>LocalModificationOverride</code> attribute which prevents that property from normally interacting with archetype updates and reversion. A property with the <code>LocalModificationOverride</code> attribute will not be uploaded with other modifications when a modified instance is uploaded to the archetype. Overrridden properties will also not be modified when an instance is reverted to archetype. The <code>LocalModificationOverride</code> attribute can be applied to properties in custom Nada components as well.</p>
<h2 id="component-modifications">Component Modifications</h2>
<p>Adding, removing, or reordering a component to an Archetype instance modifies it from Archetype.</p>
<p><em>Unmodified</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46867.png" alt="image"></p>
<p><em>Component added</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46850.png" alt="image"></p>
<p><em>Component removed</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46852.png" alt="image"></p>
<p><em>Components reordered</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46871.png" alt="image"></p>
<h2 id="child-modifications">Child Modifications</h2>
<p>Adding, removing, reordering a child object from an Archetype instance will also mark the Archetype as modified.</p>
<p><em>Unmodified</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46873.png" alt="image"></p>
<p><em>Child added</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46881.png" alt="image"></p>
<p><em>Child removed</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46877.png" alt="image"></p>
<p><em>Children reordered</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46879.png" alt="image"></p>
<p>It is important to note that neither component nor child modifications have functionality equivalent to LocalModificationOverride available. Property modifications usually adjust some factor of a piece of functionality. However, component and child object operations have the potential change the fundamental functionality of the Archetype. In the case where a certain component or child object modification becomes common place it should be add to the original archetype (and have the originally unmodified instances use LocalModificationOverride) or create a new archetype with the modifications.</p>
<h1 id="upload-to-archetype">Upload To Archetype</h1>
<p>Above we discussed the various modification types you can make to an Archetype. It is very common for a developer to create many instances of an Archetype then modify some paticular instance. However, sometimes we want to go the opposite direction and apply modifications we have made to an individual instance to the Archetype. Thinking about the army of characters we used as an example earlier. Imagine we had been changing hat colors for awhile and we decide we like a paticular color for the default. By clicking <img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46805.png" alt="image"> we can turn a[pply this change to all unmodified instances of the Archetype. This is called uploading to Archetype. Whereas if we give it a new Archetype name and click <img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46805.png" alt="image">  we will create a new Archetype.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46892.gif" alt="UploadToArchetype"></p>
<p>Here we modify right two of the three Archetype instances. The middle instance, which is modified, is then uploaded to the Archetype causing the modification to be applied to the unmodified instance on the left. Notice that the other modified instance on the right does not turn Red. This is due to the right instance being already modified from the orginal Archetype (meaning it is modified from the newly uploaded version as well).</p>
<h1 id="revert-to-archetype">Revert To Archetype</h1>
<h2 id="reverting-cogs">Reverting Cogs</h2>
<p>Often developers make accidental or undesireable changes to an Archetype instance and have legitamate reasons to not want to undo everything to revert the instances back to their original state. This is one of the many reasons Archetype instances can be reverted to the current state of the Archetype resource using the <img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46894.png" alt="image"> button next the Archetype field in the property window.</p>
<p><em>Here you can see the middle sprite reverted to match the orginal Archetype.</em></p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46896.gif" alt="RevertToArchetype"></p>
<h2 id="reverting-properties">Reverting Properties</h2>
<p>Often it is necessary to revert individual properties on an Archetype instance. This is a simple operation:</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46898.png" alt="image"></p>
<p>By using <code>RightClick</code> on the property grid one can open the context menu allowing the property to be reverted without affecting the rest of the instance. This is important and simply setting the modified field to the same value will not make the field appear un-modified to the engine.</p>
<h2 id="reverting-locally-removed-child">Reverting Locally Removed Child</h2>
<p>By using <code>RightClick</code> on the greyed out representation of objects which have been removed from the child hierarchy of an Archetype one can <code>Restore</code> an object back into the heirarchy.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46900.png" alt="image"></p>
<h2 id="reverting-child-order">Reverting Child Order</h2>
<p>If children in an Archetype hierarchy are reordered, their order can be reverted to match the current Archetype by using <code>RightClick</code> on the Archetype instance root object and selecting <code>Restore Child Order</code>.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46902.png" alt="image"></p>
<p>Reverting child modifications are important as for reasons of reverting</p>
<h1 id="marking-as-modified">Marking as Modified</h1>
<p>There are time where an Archetype is about to be upload, but it is realized there is a single unmodified instance of the Archetype which should not be updated to the new Archetype. In this case it is possible to manually mark a property as modified even if its value matches that of the original Archetype. This allows the Archetype to be updated without having the changes affecting the instance which has a locally overridden property.</p>
<p><img src="https://raw.githubusercontent.com/ZilchEngine/ZilchFiles/master/doc_files/46906.gif" alt="LocalModificationOverride"></p>
<p>Once again let's think back to the army of characters all created from the same Archetype, specifically the example where we have been experiementing and have just settled in on the hat color we would like to be the default for the whole army. Now imagine we want the leader to keep the original hat color. By marking the leader's hat color as modified, when we upload the new color to the Archetype the leader will not be affected.</p>
<p>(NOTE)<strong>Nested Archetypes</strong>: Nested archetypes are supported and are currently int the #zilch_editor_documentation pipeline: T391</p>
<h1 id="related-materials">Related Materials</h1>
<h2 id="manual">Manual</h2>
<ul>
<li><a href="https://github.com/ZilchEngine/ZilchDocs/blob/master/zilch_editor_documentation/zilchmanual/architecture/resources.md"> Resource </a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ZilchEngine/ZilchEngineWebsite/blob/master/docs/zilch_editor_documentation/zilchmanual/architecture/archetypes/archetype_basics.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          ZilchEngine 2024
        </div>
      </div>
    </footer>
  </body>
</html>
